"0","# Model parameters"
"0","alpha <- 5 # per day"
"0","mu <- 0 # per day"
"0","sigma <- 0.2 # per day"
"0","omega <- 0 # per day"
"0","tau <- 0"
"0","beta.1 <- 0.1"
"0","beta.2 <- 0.1"
"0",""
"0","strain.2.day <- 999"
"0",""
"0","S.init <- 99"
"0","I.1.init <- 1"
"0","I.2.init <- 0"
"0","S.1.init <- 0"
"0","S.2.init <- 0"
"0","J.1.init <- 0"
"0","J.2.init <- 0"
"0","S.1.2.init <- 0"
"0",""
"0","time.step <- 1"
"0","n.steps <- 100"
"0",""
"0","S <- S.init"
"0","I.1 <- I.1.init"
"0","I.2 <- ifelse(strain.2.day == 0, 1, 0)"
"0","S.1 <- 0"
"0","S.2 <- 0"
"0","J.1 <- 0"
"0","J.2 <- 0"
"0","S.1.2 <- 0"
"0","N <- S + I.1 + I.2 + S.1 + S.2 + J.1 + J.2 + S.1.2"
"0",""
"0","# Difference-equation model"
"0","for (t in 1:(n.steps-1)) {"
"0","  S[t+1] <- S[t] + (mu * N) - (alpha * (beta.1 * (I.1[t] + J.1[t]) + beta.2 * (I.2[t] + J.2[t]))) * S[t] / N - S[t] * mu"
"0","  I.1[t+1] <- I.1[t] + alpha * beta.1 * (I.1[t] + J.1[t]) * S[t] / N - (sigma + mu) * I.1[t]"
"0","  I.2[t+1] <- I.2[t] + alpha * beta.2 * (I.2[t] + J.2[t]) * S[t] / N - (sigma + mu) * I.2[t] + ifelse(t == strain.2.day, 1, 0)"
"0","  S.1[t+1] <- S.1[t] + sigma * I.1[t] - alpha * beta.2 * (I.2[t] + J.2[t]) * tau * S.1[t] / N - mu * S.1[t]"
"0","  S.2[t+1] <- S.2[t] + sigma * I.2[t] - alpha * beta.1 * (I.1[t] + J.1[t]) * tau * S.2[t] / N - mu * S.2[t]"
"0","  J.1[t+1] <- J.1[t] + alpha * beta.1 * (I.1[t] + J.1[t]) * tau * S.2[t] / N - (sigma + mu) * J.1[t]"
"0","  J.2[t+1] <- J.2[t] + alpha * beta.2 * (I.2[t] + J.2[t]) * tau * S.1[t] / N - (sigma + mu) * J.2[t]"
"0","  S.1.2[t+1] <- S.1.2[t] + sigma * (J.1[t] + J.2[t]) - mu * S.1.2[t]"
"0","}"
"0",""
"0","# Model outputs"
"0","df <- data.frame(day = c(1:100), S, I.1, I.2, S.1, S.2, J.1, J.2, S.1.2, N)"
"0",""
"0","total.cases.strain.1 <- as.integer((sum(df$I.1) + sum(df$J.1)) * sigma)"
"0","total.cases.strain.1"
"1","[1]"
"1"," 90"
"1","
"
"0","total.cases.strain.2 <- as.integer((sum(df$I.2) + sum(df$J.2)) * sigma)"
"0","total.cases.strain.2"
"1","[1]"
"1"," 0"
"1","
"
"0","R0.strain.1 <- alpha/sigma*beta.1"
"0","R0.strain.1"
"1","[1]"
"1"," 2.5"
"1","
"
"0","R0.strain.2 <- alpha/sigma*beta.2"
"0","R0.strain.2"
"1","[1]"
"1"," 2.5"
"1","
"
"0","plot1 <- ggplot(data=df, aes(x=day, y=I.1)) +"
"0","  geom_line(aes(y=I.1, color=""I.1"", linetype=""I.1""), size=2) +"
"0","  geom_line(aes(y=I.2, color=""I.2"", linetype=""I.2""), size=2) +"
"0","  geom_line(aes(y=J.1, color=""J.1"", linetype=""J.1""), size=2) +"
"0","  geom_line(aes(y=J.2, color=""J.2"", linetype=""J.2""), size=2) +"
"0","  scale_linetype_manual(name=""Legend:"", values=c(""I.1""=""twodash"",""I.2""=""longdash"",""J.1""=""dotdash"",""J.2""=""dashed"")) +"
"0","  scale_color_manual(name=""Legend:"", values=c(""I.1""=""#999999"",""I.2""=""#E69F00"",""J.1""=""#56B4E9"",""J.2""=""#009E73"")) +"
"0","  xlab(""Time (Days)"") + ylim(0,100) + ylab(""Count"")"
"0","plot1"
